##第三方免登录跳转创建表单页面接口说明

###接口地址
* http://m.oa.chaoxing.com/api/manager/third/user/login/apps/create?aprvAppId=&formId=&formType=&departmentId=&toUrl=&uid=&errorUrl=&enc=

|参数名称|是否必填|参数类型|参数名称|参数说明|
|:----    |:----|:----- |:-----   |-----   |
|fid      |是  |int | 当前单位ID    |单位fid|
|uid      |是  |int | 当前单位管理员ID    |用户uid|
|datetime |是  |string |生成加密串时间   | 格式：yyyyMMddHH|
|sign     |是  |string | 接口标识    | 由超星办公系统方提供|
|enc      |是  |string | 接口参数加密串    |采用md5加密方式进行生成|
|formId   |否  |int | 表单ID    | 表单ID|
|isCopy   |是  |int | 标识复制表单    |0：不复制；1：复制（formId不为空）|
|formType |是  |int | 应用类型标识    | 1.自建审批（不支持isCopy）2. 自定义表单|
|aprvAppId   |否  |int | 应用唯一标识   | 应用唯一标识|
|toUrl   |否  |string | 回跳地址    | 接口调用成功，并发布完应用自动回跳地址，在请求接口时需要进行一次encode-utf8编码|
|errorUrl |否  |string | 验证失败后跳转地址    | 在请求接口时需要进行一次encode-utf8编码|

 
### 处理结果
（1）接口调用成功，并发布完应用

* 自动返回到toUrl指定页面
  
（2）接口调用失败

* 跳转到errorUrl配置的页面，如果没有指定此参数则默认跳转到办公通后台登录页面

###接口参数配置
（1）加密秘钥
> key=xxxxxxxx

（2）加密方式字符串
> date="yyyy-MM-dd";
> source="[datetime=2019040818][formId=xxx][sign=xxx][uid=xxx]……";

（3） MD5加密操作
> enc=md5(source+[key]);

**注意事项**
（1）生成enc值的参数名称列表必须通过字母a-z的顺序依次组合

* 例如：[a=1][b=2][c=3][ei=4][ej=5]

（2）生成enc值时如果某个参数的值存在多个，在加密过程中要将这些值通过英文逗号进行组合

* 例如：[a=1,2,3,4,5,6]

* 创建表单页面 两个地方触发postMessage传递数据 返回结构如下：
* 点击返回：
```js
{"action":"goback","from":"form","data":{}}
```
* 点击发布：
```js
{"action":"release","from":"form","data":{"fid":63555,"formId":50711,"uid":73361131,"formType":2,"pcUrl":"http://t.chaoxing.com/front/web/micro/api/gopage?backUrl=http%3A%2F%2Ft.chaoxing.com%2Ffront%2Fweb%2Fapps%2Fforms%2Ffore%2Fapply%3Fid%3D50711%26formAppId%3D%26enc%3D277c1eb523842377c429c6718453a172","name":"第三方","icon":"http://pan-yz.chaoxing.com/thumbnail/origin/2d87595486b0f93e4a01d26e1c4b52be","openAddr":"http://t.chaoxing.com/front/apps/forms/fore/apply?id=50711&formAppId=&enc=277c1eb523842377c429c6718453a172","wechatUrl":"http://t.chaoxing.com/front/apps/forms/fore/apply?id=50711&formAppId=&enc=277c1eb523842377c429c6718453a172"}}
```