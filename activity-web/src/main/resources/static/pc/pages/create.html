<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/lib/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/create.css">
    <title>创建活动</title>
</head>

<body>
    <div class="page" id="app">

        <!-- 创建活动头部 -->
        <div class="top flex box" id="create">
            <div class="flex">
                <img src="../assets/images/left.png" alt="" class="left">
                <span class="create">创建活动</span>
            </div>
            <div v-show="!pageShow">
                <button type="button" class="cancle-btn" @click="handleNext">下一步</button>
            </div>
            <div v-show="pageShow">
                <button type="button" class="cancle-btn" @click="handleLast">上一步</button>
            </div>
        </div>
        <!-- 编辑活动头部 -->
        <div class="top flex box" id="edit" style="display: none;">
            <div class="flex">
                <img src="../assets/images/left.png" alt="" class="left">
                <span class="create">编辑活动</span>
            </div>
            <div>
                <button type="button" class="cancle-btn">预览</button>
                <button type="button" class="create-btn">保存</button>
            </div>
        </div>
        <div class="info box" v-show="!pageShow">
            <form action="">
                <div class="title">基本信息</div>
                <div class="form-item">
                    <label class="label">名称</label>
                    <div class="input-box">
                        <el-input type="text" placeholder="请填写信息，简短的活动名称" v-model="name" maxlength="20" show-word-limit>
                        </el-input>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">时间</label>
                    <div class="input-box">
                        <el-date-picker v-model="time1" type="daterange" range-separator="至" start-placeholder="开始日期"
                            end-placeholder="结束日期">
                        </el-date-picker>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label" style="line-height: 100px;">封面</label>
                    <div class="input-box">
                        <img src="../assets/images/example.jpg" alt="" class="cover-img">
                        <div class="font-box">   
                            <span>建议尺寸：1080x500</span>
                            <span>大小：小于5M</span>
                            <span>格式：jpg、png、gif</span>
                            <input type="file" class="upload-btn" accept="image/gif, image/jpg, image/png"
                                onchange="showImg(this)" />
                            <div class="cancle-btn upload">上传文件</div>
                        </div>
                        
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">活动类型</label>
                    <div class="input-box">
                        <div class="radio-box"><input type="radio" name="active-type" title="线上活动"
                                value="0" /><span>线上活动</span></div>
                        <div class="radio-box">
                            <input type="radio" name="active-type" title="线下活动" value="1" checked /><span>线下活动</span>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">位置</label>
                    <div class="input-box">
                        <input type="text" name="title" required lay-verify="required" placeholder="请输入活动地点"
                            autocomplete="off" class="layui-input name" @focus="handleFocus">
                        <img src="../assets/images/location.png" alt="" class="length icon">
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">活动分类</label>
                    <div class="input-box">
                        <div class="type-item active">活动</div>
                        <div class="type-item">讲座</div>
                        <div class="type-item">征文</div>
                        <div class="type-item">自定义选项
                            <img src="../assets/images/more.png" alt="" style="margin-left: 10px;">
                            <div class="edit-box">
                                <div @click="handleEdit">编辑</div>
                                <div @click="handleDelete">删除</div>
                            </div>
                        </div>
                        <div class="type-item" @click="handleAdd"> <img src="../assets/images/add.png" alt=""
                                style="margin-right: 10px;">新增</div>
                    </div>
                </div>
            </form>
        </div>
        <div class="info box" v-show="!pageShow">
            <div class="set-box">
                <div class="title set">报名设置</div>
                <el-switch v-model="delivery" class="switch"></el-switch>
            </div>
            <!-- 点击参与设置 -->
            <form action="" class="setForm" v-show="delivery">
                <!-- <div class="form-item">
                    <label class="label">参与形式</label>
                    <div class="input-box">
                        <div class="radio-box">
                            <input type="radio" name="method" value="1" v-model="radio" /><span>报名</span>
                        </div>
                        <div class="radio-box">
                            <input type="radio" name="method" value="2" v-model="radio" /><span>签到</span>
                        </div>
                        <div class="radio-box">
                            <input type="radio" name="method" value="3" v-model="radio" /><span>报名后签到</span>
                        </div>
                    </div>
                </div> -->
                <div class="form-item">
                    <label class="label">报名时间</label>
                    <div class="input-box">
                        <el-date-picker v-model="time2" type="daterange" range-separator="至" start-placeholder="开始日期"
                            end-placeholder="结束日期">
                        </el-date-picker>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">人数限制</label>
                    <div class="input-box">
                        <div class="select-person">
                            <el-select v-model="value1" placeholder="请选择">
                                <el-option v-for="item in options1" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <input type="number" placeholder="请输入正整数" class="person" v-show="value1 == 2">
                        <span class="person-span" v-show="value1 == 2">人</span>
                    </div>
                </div>
                <!-- <div class="form-item" v-show="radio==1">
                    <label class="label">报名方式</label>
                    <div class="input-box">
                        <div class="select" style="margin-top: 0;">
                            <el-select v-model="value2" placeholder="请选择">
                                <el-option v-for="item in options2" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <span class="tips">参与者点击报名即成功</span>
                    </div>
                </div>
                <div class="form-item" v-show="radio==2">
                    <label class="label">签到方式</label>
                    <div class="input-box">
                        <div class="select" style="margin-top: 0;">
                            <el-select v-model="value4" placeholder="请选择">
                                <el-option v-for="item in options4" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <span class="tips">参与者点击签到即成功</span>
                    </div>
                </div>
                <div class="form-item" v-show="radio==3">
                    <label class="label">签到方式</label>
                    <div class="input-box">
                        <div class="select" style="margin-top: 0;">
                            <el-select v-model="value5" placeholder="请选择">
                                <el-option v-for="item in options5" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <span class="tips">参与者需要到达指定位置才能进行签到</span>
                    </div>
                </div> -->
                <div class="form-item">
                    <label class="label" style="line-height: 20px;">信息填写</label>
                    <div class="input-box column">
                        <div class="set-box">
                            <el-switch v-model="delivery2"></el-switch>
                            <span class="tips">如何创建报名信息表单？</span>
                        </div>
                        <div class="select" v-show="delivery2">
                            <el-select v-model="value3" placeholder="请选择">
                                <el-option v-for="item in options3" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">报名名单公开</label>
                    <div class="input-box">
                        <el-switch v-model="delivery3"></el-switch>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">按钮名称</label>
                    <div class="input-box btn-name">
                        <el-input type="text" placeholder="请输入内容" v-model="btnName1" maxlength="6" show-word-limit>
                        </el-input>
                    </div>
                </div>
            </form>
        </div>
        <div class="info box" v-show="!pageShow">
            <div class="set-box">
                <div class="title set">签到设置</div>
                <el-switch v-model="delivery1" class="switch"></el-switch>
            </div>
            <!-- 点击参与设置 -->
            <form action="" class="setForm" v-show="delivery1">
                <div class="form-item">
                    <label class="label">签到方式</label>
                    <div class="input-box">
                        <div class="radio-box">
                            <input type="radio" name="method" value="1" v-model="radio" /><span>报名</span>
                        </div>
                        <div class="radio-box">
                            <input type="radio" name="method" value="2" v-model="radio" /><span>签到</span>
                        </div>
                        <div class="radio-box">
                            <input type="radio" name="method" value="3" v-model="radio" /><span>报名后签到</span>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">签到时间</label>
                    <div class="input-box">
                        <el-date-picker v-model="time3" type="daterange" range-separator="至" start-placeholder="开始日期"
                            end-placeholder="结束日期">
                        </el-date-picker>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">人数限制</label>
                    <div class="input-box">
                        <div class="select-person">
                            <el-select v-model="value1" placeholder="请选择">
                                <el-option v-for="item in options1" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <input type="text" placeholder="请输入正整数" class="person" v-show="value1 == 2"><span
                            class="person-span">人</span>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label" style="line-height: 20px;">信息填写</label>
                    <div class="input-box column">
                        <div class="set-box">
                            <el-switch v-model="delivery2"></el-switch>
                            <span class="tips">如何创建报名信息表单？</span>
                        </div>
                        <div class="select" v-show="delivery2">
                            <el-select v-model="value3" placeholder="请选择">
                                <el-option v-for="item in options3" :key="item.value" :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">报名名单公开</label>
                    <div class="input-box">
                        <el-switch v-model="delivery3"></el-switch>
                    </div>
                </div>
                <div class="form-item">
                    <label class="label">按钮名称</label>
                    <div class="input-box btn-name">
                        <el-input type="text" placeholder="请输入内容" v-model="btnName1" maxlength="6" show-word-limit>
                        </el-input>
                    </div>
                </div>
            </form>
        </div>
        <!-- 去掉了 -->
        <div class="info box" style="display: none;">
            <div class="set-box">
                <div class="title">模块配置</div>
                <span class="tips">按住鼠标左键调整模块的顺序</span>
            </div>
            <div class="item-box">
                <div class="modle-item" v-for="modular in modularArr" draggable="true"
                    @dragstart="handleDragStart($event, modular)" @dragover.prevent="handleDragOver($event, modular)"
                    @dragenter="handleDragEnter($event, modular)" @dragend="handleDragEnd($event, modular)">
                    <img src="../assets/images/dellete-red.png" alt="" class="dellete">
                    <img :src="modular.imgSrc" alt="" class="img">
                    <span>{{modular.title}}</span>
                </div>
                <div class="modle-item add" id="addModle">
                    <div><img src="../assets/images/add.png" alt=""></div>
                    <span>添加模块</span>
                </div>
            </div>
        </div>
        <div class="info box" v-show="pageShow">
            <div class="title">选择模板</div>
            <!-- 创建活动时选择模板 -->
            <div class="page-show">
                <div class="page-box">
                    <div class="page-item">
                        <div class="mask-box">
                            <img src="../assets/images/example.jpg" alt="" class="img">
                            <div class="mask">
                                <div class="normal-btn preview" @click="preview">预览</div>
                                <div class="normal-btn after-sure">选择</div>
                            </div>
                        </div>
                        <div class="desc overHidden1">征文活动</div>
                    </div>
                    <div class="page-item">
                        <div class="mask-box">
                            <img src="../assets/images/example.jpg" alt="" class="img">
                            <div class="mask">
                                <div class="normal-btn preview">预览</div>
                                <div class="normal-btn after-sure">选择</div>
                            </div>
                        </div>
                        <div class="desc overHidden1">暑期教师共读活动</div>
                    </div>
                    <div class="page-item">
                        <div class="mask-box">
                            <img src="../assets/images/example.jpg" alt="" class="img">
                            <div class="mask">
                                <div class="normal-btn preview">预览</div>
                                <div class="normal-btn after-sure">选择</div>
                            </div>
                        </div>
                        <div class="desc overHidden1">书海拾贝·辰星领航 - 暑期星阅读活动暑期星…</div>
                    </div>
                    <div class="page-item">
                        <div class="mask-box">
                            <img src="../assets/images/example.jpg" alt="" class="img">
                            <div class="mask">
                                <div class="normal-btn preview">预览</div>
                                <div class="normal-btn after-sure">选择</div>
                            </div>
                        </div>
                        <div class="desc overHidden1">阅往昔·致未来</div>
                    </div>
                    <div class="page-item">
                        <div class="mask-box">
                            <img src="../assets/images/example.jpg" alt="" class="img">
                            <div class="mask">
                                <div class="normal-btn preview">预览</div>
                                <div class="normal-btn after-sure">选择</div>
                            </div>
                        </div>
                        <div class="desc overHidden1">阅往昔·致未来</div>
                    </div>
                </div>
                <el-pagination background layout="prev, pager, next" :total="1000">
                </el-pagination>
            </div>
            <!-- 编辑活动时预览模板 已取消-->
            <div class="page-show" style="display: none;">
                <div class="page-item">
                    <img src="../assets/images/example.jpg" alt="" class="img">
                    <!-- hover时出现 -->
                    <div class="mask">
                        <div class="normal-btn preview">预览</div>
                        <div class="normal-btn after-sure">页面配置</div>
                    </div>
                </div>
                <div class="page-item">
                    <img src="../assets/images/example.jpg" alt="" class="img">
                    <div class="mask">
                        <div class="normal-btn preview">预览</div>
                        <div class="normal-btn after-sure">页面配置</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 新增活动分类和自定义选项的弹出框 -->
        <div class="dailog-box1" v-show="fenleiShow">
            <div class="dailog">
                <div class="header">
                    <span>分类名称</span>
                    <img src="../assets/images/close.png" alt="" class="close" @click="close">
                </div>
                <div class="body">
                    <el-input type="text" class="fenlei-input" placeholder="请输入" v-model="fenlei" maxlength="6"
                        show-word-limit></el-input>
                </div>
                <div class="footer">
                    <div class="normal-btn cancle" @click="handleCancle">取消</div>
                    <div class="normal-btn before-sure">确定</div>
                </div>
            </div>
        </div>
        <!-- 添加模块的弹出框 -->
        <div class="dailog-box2" style="display: none;">
            <div class="dailog">
                <div class="header">
                    <span>添加模块</span>
                    <img src="../assets/images/close.png" alt="" class="close">
                </div>
                <div class="body">
                    <!-- 添加模块 -->
                    <div class="add-modle" style="display: none;">
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>作品征集</span>
                        </div>
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>测评</span>
                        </div>
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>打卡</span>
                        </div>
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>地图闯关</span>
                        </div>
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>小组</span>
                        </div>
                        <div class="add-item">
                            <img src="../assets/images/selected.png" alt="" class="selected">
                            <div>
                                <img src="../assets/images/lizi.png" alt="" class="img">
                            </div>
                            <span>超链接</span>
                        </div>
                    </div>
                    <!-- 添加或编辑模块详情 点击下一步出现-->
                    <div class="add-details">
                        <form action="">
                            <div class="form-item">
                                <label class="label">名称</label>
                                <div class="input-box add-name">
                                    <el-input type="text" placeholder="请填写名称" v-model="name2" maxlength="10"
                                        show-word-limit>
                                </div>
                            </div>
                            <div class="form-item">
                                <label class="label">图标</label>
                                <div class="input-box add-name">
                                    <img src="../assets/images/example.jpg" alt="" class="add-img">
                                    <div class="font-box">
                                        <span>尺寸256*256，大小500kb以下图标；格式png、gif、jpg</span>
                                        <input type="file" class="upload-btn" accept="image/gif, image/jpg, image/png"
                                            onchange="showImg1(this)" />
                                        <div class="upload-icon">上传</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-item">
                                <label class="label">展示终端</label>
                                <div class="input-box add-name">
                                    <div class="radio-box"><input type="checkbox" name="method" checked
                                            value="0" /><span>电脑端</span>
                                    </div>
                                    <div class="radio-box">
                                        <input type="checkbox" name="method" value="1" /><span>移动端</span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- 上一步按钮 -->
                <div class="footer">
                    <div class="normal-btn cancle">取消</div>
                    <div class="normal-btn after-sure" id="next-step">下一步</div>
                </div>
                <!-- 下一步按钮 -->
                <div class="footer" style="display: none;">
                    <div class="normal-btn" id="last-step">上一步</div>
                    <div class="normal-btn after-sure" id="complete">完成</div>
                </div>
            </div>
        </div>
        <!-- 确认删除模块弹框 -->
        <div class="dailog-box3" style="display: none;">
            <div class="dailog delete-dailog">
                <img src="../assets/images/warning.png" alt="" class="warn">
                <span>删除后，可重新添加。确定删除？</span>
                <div>
                    <div class="normal-btn">保留</div>
                    <div class="normal-btn after-sure">删除</div>
                </div>
            </div>
        </div>
        <!-- 确认删除分类弹框 -->
        <div class="dailog-box3" v-show="deleteShow">
            <div class="dailog delete-dailog">
                <img src="../assets/images/warning.png" alt="" class="warn">
                <span>确认删除此分类</span>
                <div>
                    <div class="normal-btn" @click="handleSave">保留</div>
                    <div class="normal-btn after-sure" @click="handleSure">删除</div>
                </div>
            </div>
        </div>
        <!-- 活动创建成功弹框 -->
        <div class="dailog-box3" style="display: none;">
            <div class="dailog delete-dailog">
                <img src="../assets/images/success.png" alt="" class="warn">
                <span>活动创建成功</span>
                <div>
                    <div class="normal-btn">配置页面</div>
                    <div class="normal-btn after-sure">完成</div>
                </div>
            </div>
        </div>
        <!-- 查看模块详情 -->
        <div class="dailog-box4" style="display: none;">
            <div class="dailog details-dailog">
                <img src="../assets/images/close.png" alt="" class="close">
                <div class="details-item">
                    <img src="../assets/images/lizi.png" alt="" class="details-img">
                    <div>
                        <div style="display: flex;">
                            <div class="desc overHidden2">作品征集作品征集作品征集作品征集作品征集作品征集作品征集作品征集征…</div>
                            <div class="edit-img">
                                <img src="../assets/images/icon-edit.png" alt="" style="margin-right: 6px;">
                                <span>编辑</span>
                            </div>
                        </div>
                        <div class="img-flex">
                            <img src="../assets/images/icon-pc.png" alt="" style="margin-right: 14px;">
                            <img src="../assets/images/app.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="visit">
                    <span>访问</span>
                    <div class="normal-btn">PC端</div>
                    <div class="normal-btn">APP端</div>
                </div>
            </div>
        </div>
        <!-- 预览弹窗 -->
        <div class="dailog-box1" v-show="previewShow">
            <div class="dailog look-dailog">
                <div class="header">
                    <span>预览</span>
                    <img src="../assets/images/close.png" alt="" class="close" @click="close">
                </div>
                <div class="body">
                    <!-- 二维码 -->
                    <div class="code"><img src="../assets/images/example.jpg" alt=""></div>
                    <span>使用学习通扫码查看</span>
                    <div class="link-box">
                        <span>链接</span>
                        <input type="text" class="input-link" :value="link">
                        <a :href="link">访问</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- 地图 -->
        <div class="dailog-box1" v-show="addressShow">
            <div class="dailog map-dailog">
                <div class="header">
                    <span>设置地图</span>
                    <img src="../assets/images/close.png" alt="" class="close" @click="close">
                </div>
                <div class="body">
                    <div class="body-head">
                        <div class="input-addr">
                            <el-autocomplete style="width:100%;" popper-class="autoAddressClass" v-model="address"
                                :fetch-suggestions="querySearchAsync" :trigger-on-focus="false" placeholder="请输入地址"
                                @select="handleSelect" clearable>
                                <template slot-scope="{ item }"> <i class="el-icon-search fl mgr10"></i>
                                    <div class="address-box">
                                        <div class="title1">{{ item.title }}</div>
                                        --
                                        <span class="address ellipsis">{{ item.address }}</span>
                                    </div>
                                </template>
                            </el-autocomplete>
                        </div>
                        <div class="normal-btn after-sure">确定</div>
                    </div>
                    <div id="map-contain" class="map">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=aG5nWGO5m5tkVhBHGuVppoIRfKbyp5H3">
    </script>
    <script src="../assets/lib/jquery.min.js"></script>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="../assets/lib/element-ui/lib/index.js"></script>
    <script src="../assets/js/common.js"></script>
    <script src="../assets/js/create-active.js"></script>

    <script>
        // vue
        var app = new Vue({
            el: '#app',
            data: {
                name: '',
                btnName1: '按钮',
                btnName2: '签到',
                name2: '',
                radio: 3,
                value1: '1',
                value2: '',
                value3: '1',
                value4: '',
                value5: '',
                fenlei: '',
                delivery: true,
                delivery1: false,
                delivery2: true,
                delivery3: false,
                time1: ['2020-11-16', '2020-11-17'],
                time2: '',
                time3: '',
                options1: [{
                    value: "1",
                    label: "无限制",

                }, {
                    value: "2",
                    label: "自定义人数"
                }],
                options2: [{
                    value: "1",
                    label: "直接报名",

                }, {
                    value: "2",
                    label: "需扫码进行报名"
                }],
                options3: [{
                    value: "1",
                    label: "万能表单",

                }, {
                    value: "2",
                    label: "表单名称"
                }],
                options4: [{
                    value: "1",
                    label: "直接签到",

                }, {
                    value: "2",
                    label: "指定位置签到"
                }, {
                    value: "3",
                    label: "需扫码进行签到"
                }],
                options5: [{
                    value: "1",
                    label: "指定位置签到",

                }, {
                    value: "2",
                    label: "需扫码进行签到"
                }],
                address: '', //详细地址 
                addrPoint: {
                    lng: 0,
                    lat: 0
                },
                map: '', //地图实例 
                mk: '', //Marker实例
                // 模块数据
                modularArr: [{
                        imgSrc: 'https://p.ananas.chaoxing.com/star3/320_150c/572280b525982f6d3c51fd3fb5ef7449.jpeg',
                        title: "作品征集"
                    },
                    {
                        imgSrc: 'https://p.ananas.chaoxing.com/star3/320_150c/572280b525982f6d3c51fd3fb5ef7449.jpeg',
                        title: "打卡"
                    },
                    {
                        imgSrc: 'https://p.ananas.chaoxing.com/star3/320_150c/572280b525982f6d3c51fd3fb5ef7449.jpeg',
                        title: "打卡1"
                    },
                ],
                dragging: null,
                pageShow: false,
                addressShow: false,
                fenleiShow: false,
                deleteShow: false,
                previewShow: false,
                link: "http://xueya.chaoxing.com/school-base/sc-sc-"
            },
            mounted() {
                this.initMap()
            },
            methods: {
                initMap() {
                    var that = this;
                    this.map = new BMap.Map("map-contain", {
                        enableMapClick: false
                    }) //新建地图实例，enableMapClick:false ：禁用地图默认点击弹框 
                    var point = new BMap.Point(104.10194, 30.65984);
                    this.map.centerAndZoom(point, 19);
                    this.map.enableScrollWheelZoom(true) //启用滚轮放大缩小，默认禁用
                    this.mk = new BMap.Marker(point)
                    this.map.addOverlay(this.mk)
                    this.map.addEventListener('click', function (e) { //给地图绑定点击事件 
                        that.getAddrByPoint(e.point) //点击后调用逆地址解析函数 
                    })
                },
                //逆地址解析
                getAddrByPoint(point) {
                    var that = this;
                    var geco = new BMap.Geocoder();
                    geco.getLocation(point, function (res) {
                        console.log(res) //内容见下图 
                        that.mk.setPosition(point) //重新设置标注的地理坐标 
                        that.map.panTo(point) //将地图的中心点更改为给定的点 
                        that.address = res.address; //记录该点的详细地址信息 
                        that.addrPoint = point; //记录当前坐标点 
                    })
                },
                querySearchAsync(str, cb) {
                    var options = {
                        onSearchComplete: function (res) { //检索完成后的回调函数 
                            var s = [];
                            if (local.getStatus() == BMAP_STATUS_SUCCESS) {
                                for (var i = 0; i < res.getCurrentNumPois(); i++) {
                                    s.push(res.getPoi(i));
                                }
                                cb(s) //获取到数据时，通过回调函数cb返回到<el-autocomplete>组件中进行显示 
                            } else {
                                cb(s)
                            }
                        }
                    }
                    var local = new BMap.LocalSearch(this.map, options) //创建LocalSearch构造函数 
                    local.search(str) //调用search方法，根据检索词str发起检索
                },
                handleSelect(item) {
                    this.address = item.address + item.title; //记录详细地址，含建筑物名 
                    this.addrPoint = item.point; //记录当前选中地址坐标 
                    this.map.clearOverlays() //清除地图上所有覆盖物 
                    this.mk = new BMap.Marker(item.point) //根据所选坐标重新创建Marker 
                    this.map.addOverlay(this.mk) //将覆盖物重新添加到地图中 
                    this.map.panTo(item.point) //将地图的中心点更改为选定坐标点 
                },
                //拖拽初始化
                handleDragStart(e, item) {
                    this.dragging = item;
                },
                handleDragEnd(e, item) {
                    this.dragging = null
                },
                handleDragOver(e) {
                    e.dataTransfer.dropEffect = 'move'
                },
                handleDragEnter(e, item) {
                    var $this = this;
                    e.dataTransfer.effectAllowed = "move"
                    if (item === this.dragging) {
                        return
                    }
                    var newItems = this.modularArr;
                    var src = newItems.indexOf(this.dragging);
                    var dst = newItems.indexOf(item);
                    newItems.splice(src, 1)
                    // 替换
                    newItems.splice(dst, 0, this.dragging);
                    this.modularArr = newItems;
                    console.log(this.modularArr)
                },
                handleLast() {
                    this.pageShow = false
                },
                handleNext() {
                    this.pageShow = true
                },
                handleFocus() {
                    this.addressShow = true
                    $('body').addClass('scroll')
                },
                close() {
                    this.addressShow = false
                    this.fenleiShow = false
                    this.previewShow = false
                    $('body').removeClass('scroll')
                },
                handleEdit() {
                    this.fenleiShow = true
                    this.fenlei = '自定义选项'
                    $('body').addClass('scroll')
                },
                handleAdd() {
                    this.fenleiShow = true
                    $('body').addClass('scroll')
                },
                handleDelete() {
                    this.deleteShow = true
                    $('body').addClass('scroll')
                },
                handleCancle() {
                    this.fenlei = ''
                    this.fenleiShow = false
                    $('body').removeClass('scroll')
                },
                handleSave() {
                    this.deleteShow = false
                    $('body').removeClass('scroll')
                },
                handleSure() {

                },
                preview() {
                    this.previewShow = true
                    $('body').addClass('scroll')
                }
            }
        })
    </script>
</body>

</html>