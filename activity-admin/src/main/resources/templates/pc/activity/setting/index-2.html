<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>设置</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/static/pc/assets/lib/element-ui/lib/theme-chalk/index.css" th:href="@{/pc/assets/lib/element-ui/lib/theme-chalk/index.css}">
    <link rel="stylesheet" href="/static/pc/assets/icomoon/style.css" th:href="@{/pc/assets/icomoon/style.css}">
    <link rel="stylesheet" href="/static/pc/assets/css/common.css" th:href="@{/pc/assets/css/common.css}">
    <link rel="stylesheet" href="/static/pc/assets/css/set.css" th:href="@{/pc/assets/css/set.css}">
    <link rel="stylesheet" href="/static/pc/assets/css/subMenu.css" th:href="@{/pc/assets/css/subMenu.css}">
    <style>
        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body>
<div class="container sub-container" id="vue" v-cloak>
    <div class="slider">
        <div class="menu color333">
            <div class="entry menu-item ">
                <div :class="{item: true, active: menu.active}" v-for="(menu, index) in menus" :key="'sub-menu-' + index" @click="selectMenu(index)" v-if="menu.show"><span>{{menu.name}}</span></div>
            </div>
        </div>
    </div>
    <div class="content">
        <iframe id="content" src="" width="100%" frameborder="no"></iframe>
    </div>
</div>
</body>
</html>
<div th:replace="pc/include/common_js :: common_js(~{::script})">
    <script src="/static/pc/assets/lib/layui/layui.js" th:src="@{/pc/assets/lib/layui/layui.js}"></script>
    <script src="/static/pc/assets/lib/element-ui/lib/index.js"
            th:src="@{/pc/assets/lib/element-ui/lib/index.js}"></script>
    <script th:inline="javascript">
        var vm = new Vue({
            el: '#vue',
            data: function () {
                return {
                    mainDomain: [[${mainDomain}]],
                    url: "",
                    menus: []
                }
            },
            created: function () {
                var $this = this;
                document.domain = $this.mainDomain;
                $this.menus.pushArray([
                    {
                        name: '基本信息',
                        url: ctx + "/activity/[[${activityId}]]/setting/basic-info/view",
                        active: true,
                        show: true
                    },
                    {
                        name: '报名设置',
                        url: ctx + "/activity/[[${activityId}]]/setting/sign-up",
                        active: false,
                        show: [[${openSignUp}]]
                    },
                  {
                    name: '管理员设置',
                    url: ctx + "/activity/[[${activityId}]]/manager",
                    active: false, show: true
                  },
                  {
                    name: '模块设置',
                    url: ctx + "/activity/[[${activityId}]]/setting/menu",
                    active: false,
                    show: true
                  }
                ])
            },
            mounted: function () {
                var $this = this;
                $this.initIframeHeight();
                $this.url = $this.menus[0].url;
            },
            watch: {
                url: function () {
                    var $this = this;
                    $("#content")[0].src = $this.url;
                }
            },
            methods: {
                initIframeHeight: function () {
                    $("#content").height($(window).height());
                },
                selectMenu: function (index) {
                    var $this = this;
                    var tab = $this.menus[index];
                    if (tab.active) {
                        return;
                    }
                    $($this.menus).each(function (i) {
                        $this.$set($this.menus[i], "active", false);
                    });
                    $this.$set($this.menus[index], "active", true);
                    $this.url = tab.url;
                }
            }
        });

    </script>
</div>

